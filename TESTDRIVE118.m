%% IEEE118T: IEEE118 Transmission bus system  
clc
clear
basemva = 100;  accuracy = 0.0001; accel = 1.8; maxiter = 100;
%        IEEE 30-BUS TEST SYSTEM (American Electric Power)
%        Bus Bus  Voltage Angle   ---Load---- -------Generator----- Static Mvar
%        No  code Mag.    Degree  MW    Mvar  MW  Mvar Qmin Qmax    +Qc/-Ql
busdata=[
    1		2		1.0		0		51.00		27.00		0		0		-5.0	15.0	0
2		0		1.0		0		20.00		9.00		0		0		0		0		0
3		0		1.0		0		39.00		10.00		0		0		0		0		0
4		2		1.0		0		39.00		12.00		0		0		-300.0	300.0	0
5		0		1.0		0		0.00		0.00		0		0		0		0		0
6		2		1.0		0		52.00		22.00		0		0		-13		50.0	0
7		0		1.0		0		19.00		2.00		0		0		0		0		0
8		2		1.0		0		28.00		0.00		0		0		-300.0	300.0	0
9		0		1.0		0		0.00		0.00		0		0		0		0		0
10		2		1.		0		0.00		0.00		450.00		0		-147	200		0
11		0		1.0		0		70.00		23.00		0		0		0		0		0
12		2		0.99	0		47.00		10.00		85		0		-35		120		0
13		0		1.0		0		34.00		16.00		0		0		0		0		0
14		0		1.0		0		14.00		1.00		0		0		0		0		0
15		2		1.0		0		90.00		30.00		0		0		-10.0	30.0	0
16		0		1.0		0		25.00		10.00		0		0		0		0		0
17		0		1.0		0		11.00		3.00		0		0		0		0		0
18		2		1.0		0		60.00		34.00		0		0		-16.0	50.0	0
19		2		1.0		0		45.00		25.00		0		0		-8.0	24.0	0
20		0		1.0		0		18.00		3.00		0		0		0		0		0
21		0		1.0		0		14.00		8.00		0		0		0		0		0
22		0		1.0		0		10.00		5.00		0		0		0		0		0
23		0		1.0		0		7.00		3.00		0		0		0		0		0
24		2		1.0		0		13.00		0.00		0		0		-300.0	300.0	0
25		2		1.050	0		0.00		0.00		220		0		-47		140		0
26		2		1.		0		0.00		0.00		314		0		-1000	1000	0
27		2		1.0		0		71.00		13.00		0		0		-300.0	300.0	0
28		0		1.0		0		17.00		7.00		0		0		0		0		0
29		0		1.0		0		24.00		4.00		0		0		0		0		0
30		0		1.0		0		0.00		0.00		0		0		0		0		0
31		2		1.		0		43.00		27.00		7.000		0		-300.0	300.0	0
32		2		1.0		0		59.00		23.00		0		0		-14		40.0	0
33		0		1.0		0		23.00		9.00		0		0		0		0		0
34		0		1.0		0		59.00		26.00		0		0		0		0		0
35		0		1.0		0		33.00		9.00		0		0		0		0		0
36		0		1.0		0		31.00		17.00		0		0		-8.0	24.0	0
37		0		1.0		0		0.00		0.00		0		0		0		0		0
38		0		1.0		0		0.00		0.00		0		0		0		0		0
39		0		1.0		0		27.00		11.00		0		0		0		0		0
40		2		1.0		0		66.00		23.00		0		0		-300	300		0
41		0		1.0		0		37.00		10.00		0		0		0		0		0
42		2		1.0		0		96.00		23.00		0		0		-300	300		0
43		0		1.0		0		18.00		7.00		0		0		0		0		0
44		0		1.0		0		16.00		8.00		0		0		0		0		0
45		0		1.0		0		53.00		22.00		0		0		0		0		0
46		2		1.		0		28.00		10.00		19		0		-100	100		0
47		0		1.0		0		34.00		0.00		0		0		0		0		0
48		0		1.0		0		20.00		11.00		0		0		0		0		0
49		2		1.		0		87.00		30.00		204		0		-85		210		0
50		0		1.0		0		17.00		4.00		0		0		0		0		0
51		0		1.0		0		17.00		8.00		0		0		0		0		0
52		0		1.0		0		18.00		5.00		0		0		0		0		0
53		0		1.0		0		23.00		11.00		0		0		0		0		0
54		2		1.		0		113.00		32.00		48		0		-300.0	300.0	0
55		0		1.0		0		63.00		22.00		0		0		-8		23		0
56		0		1.0		0		84.00		18.00		0		0		-8		23		0
57		0		1.0		0		12.00		3.00		0		0		0		0		0
58		0		1.0		0		12.00		3.00		0		0		0		0		0
59		2		0.985	0		277.00		113.00		155.0	0		-60		180		0
60		0		1.0		0		78.00		3.00		0		0		0		0		0
61		2		0.995	0		0.00		0.00		160		0		-100	300		0
62		2		1.0		0		77.00		14.00		0		0		-20		20		0
63		0		1.0		0		0.00		0.00		0		0		0		0		0
64		0		1.0		0		0.00		0.00		0		0		0		0		0
65		2		1.		0		0.00		0.00		391		0		-67		200		0
66		2		1.050	0		39.00		18.00		392		0		-67		200		0
67		0		1.0		0		28.00		7.00		0		0		0		0		0
68		0		1.0		0		0.00		0.00		0		0		0		0		0
69		1		1.		0		0.000		0.000		0		0		0		0		0
70		2		1.0		0		66.00		20.00		0		0		-10		32.0	0
71		0		1.0		0		0.00		0.00		0		0		0		0		0
72		2		1.0		0		12.00		0.00		0		0		-100.0	100.0	0
73		2		1.0		0		6.00		0.00		0		0		-100.0	100.0	0
74		2		1.0		0		68.00		27.00		0		0		-6.0	9.0		0
75		0		1.0		0		47.00		11.00		0		0		0		0		0
76		2		1.0		0		68.00		36.00		0		0		-8.0	23.0	0
77		2		1.0		0		61.00		28.00		0		0		-20		70.0	0
78		0		1.0		0		71.00		26.00		0		0		0		0		0
79		0		1.0		0		39.00		32.00		0		0		0		0		0
80		2		1.040	0		130.00		26.00		477		0		-165	280		0
81		0		1.0		0		0.00		0.00		0		0		0		0		0
82		0		1.0		0		54.00		27.00		0		0		0		0		0
83		0		1.0		0		20.00		10.00		0		0		0		0		0
84		0		1.0		0		11.00		7.00		0		0		0		0		0
85		2		1.0		0		24.00		15.00		0		0		-8		23		0
86		0		1.0		0		21.00		10.00		0		0		0.0		0.0		0
87		2		1.		0		0.00		0.00		4.0		0	  -100.0	1000.0	0
88		0		1.0		0		48.00		10.00		0		0		0		0		0
89		2		1.		0		0.00		0.00		607		0		-210	300		0
90		2		1.0		0		163.00		48.00		0		0		-300	300		0
91		2		1.0		0		10.00		0.00		0		0		-100	100.0	0
92		2		1.0		0		65.00		10.00		0		0		-3		9		0
93		0		1.0		0		12.00		7.00		0		0		0		0		0
94		0		1.0		0		30.00		16.00		0		0		0		0		0
95		0		1.0		0		42.00		31.00		0		0		0		0		0
96		0		1.0		0		38.00		15.00		0		0		0		0		0
97		0		1.0		0		15.00		9.00		0		0		0		0		0
98		0		1.0		0		34.00		8.00		0		0		0		0		0
99		2		1.0		0		42.00		0.00		0		0		-100	100		0
100		2		1.		0		37.00		18.00		252		0		-50		155		0
101		0		1.0		0		22.00		15.00		0		0		0		0		0
102		0		1.0		0		5.00		3.00		0		0		0		0		0
103		2		1.		0		23.00		16.00		40		0		-15		40		0
104		2		1.0		0		38.00		25.00		0		0		-8		23		0
105		2		1.0		0		31.00		26.00		0		0		-8		23		0
106		0		1.0		0		43.00		16.00		0		0		0		0		0
107		0		1.0		0		50.00		12.00		0		0		0		0		0
108		0		1.0		0		2.00		1.00		0		0		0		0		0
109		0		1.0		0		8.00		3.00		0		0		0		0		0
110		2		1.0		0		39.00		30.00		0		0		-8		23		0
111		2		1.		0		0.00		0.00		36		0		-100.0	1000.0	0
112		2		1.0		0		68.00		13.00		0		0		-100.0	1000.0	0
113		2		1.0		0		6.00		0.00		0		0		-100.0	200.0	0
114		0		1.0		0		8.00		3.00		0		0		0		0		0
115		0		1.0		0		22.00		7.00		0		0		0		0		0
116		2		1.0		0		184.00		0.00		0		0		-1000	1000	0
117		0		1.0		0		20.00		8.00		0		0		0		0		0
118		0		1.0		0		33.00		15.00		0		0		0		0		0
       ];


    

    %      |  From |  To   |   R     |   X     |    B/2  |  X'mer  |
%         |  Bus  | Bus   |  pu     |  pu     |    pu   | TAP (a) |
linedata =[
        1	2	0.03030	0.09990	0.02540	1
        1	3	0.01290	0.04240	0.01082	1
        4	5	0.00176	0.00798	0.00210	1
        3	5	0.02410	0.10800	0.02840	1
        5	6	0.01190	0.05400	0.01426	1
        6	7	0.00459	0.02080	0.00550	1
        8	9	0.00244	0.03050	1.16200	1
        8	5	0.00000	0.02670	0.00000	0.98
        9	10	0.00258	0.03220	1.23000	1
        4	11	0.02090	0.06880	0.01748	1
        5	11	0.02030	0.06820	0.01738	1
        11	12	0.00595	0.01960	0.00502	1
        2	12	0.01870	0.06160	0.01572	1
        3	12	0.04840	0.16000	0.04060	1
        7	12	0.00862	0.03400	0.00874	1
        11	13	0.02225	0.07310	0.01876	1
        12	14	0.02150	0.07070	0.01816	1
        13	15	0.07440	0.24440	0.06268	1
        14	15	0.05950	0.19500	0.05020	1
        12	16	0.02120	0.08340	0.02140	1
        15	17	0.01320	0.04370	0.04440	1
        16	17	0.04540	0.18010	0.04660	1
        17	18	0.01230	0.05050	0.01298	1
        18	19	0.01119	0.04930	0.01142	1
        19	20	0.02520	0.11700	0.02980	1
        15	19	0.01200	0.03940	0.01010	1
        20	21	0.01830	0.08490	0.02160	1
        21	22	0.02090	0.09700	0.02460	1
        22	23	0.03420	0.15900	0.04040	1
        23	24	0.01350	0.04920	0.04980	1
        23	25	0.01560	0.08000	0.08640	1
        26	25	0.00000	0.03820	0.00000	0.96
        25	27	0.03180	0.16300	0.17640	1
        27	28	0.01913	0.08550	0.02160	1
        28	29	0.02370	0.09430	0.02380	1
        30	17	0.00000	0.03880	0.00000	0.96
        8	30	0.00431	0.05040	0.51400	1
        26	30	0.00799	0.08600	0.90800	1
        17	31	0.04740	0.15630	0.03990	1
        29	31	0.01080	0.03310	0.00830	1
        23	32	0.03170	0.11530	0.11730	1
        31	32	0.02980	0.09850	0.02510	1
        27	32	0.02290	0.07550	0.01926	1
        15	33	0.03800	0.12440	0.03194	1
        19	34	0.07520	0.24700	0.06320	1
        35	36	0.00224	0.01020	0.00268	1
        35	37	0.01100	0.04970	0.01318	1
        33	37	0.04150	0.14200	0.03660	1
        34	36	0.00871	0.02680	0.00568	1
        34	37	0.00256	0.00940	0.00984	1
        %38	37	0.00000	0.03750	0.00000	0.93
        37	39	0.03210	0.10600	0.02700	1
        37	40	0.05930	0.16800	0.04200	1
        30	38	0.00464	0.05400	0.42200	1
        39	40	0.01840	0.06050	0.01552	1
        40	41	0.01450	0.04870	0.01222	1
        40	42	0.05550	0.18300	0.04660	1
        41	42	0.04100	0.13500	0.03440	1
        43	44	0.06080	0.24540	0.06068	1
        34	43	0.04130	0.16810	0.04226	1
        44	45	0.02240	0.09010	0.02240	1
        45	46	0.04000	0.13560	0.03320	1
        46	47	0.03800	0.12700	0.03160	1
        46	48	0.06010	0.18900	0.04720	1
        47	49	0.01910	0.06250	0.01604	1
        42	49	0.03570	0.16150	0.02150	1
        45	49	0.06840	0.18600	0.04440	1
        48	49	0.01790	0.05050	0.01258	1
        49	50	0.02670	0.07520	0.01874	1
        49	51	0.04860	0.13700	0.03420	1
        51	52	0.02030	0.05880	0.01396	1
        52	53	0.04050	0.16350	0.04058	1
        53	54	0.02630	0.12200	0.03100	1
        49	54	0.03970	0.14500	0.01830	1
        54	55	0.01690	0.07070	0.02020	1
        54	56	0.00275	0.00955	0.00732	1
        55	56	0.00488	0.01510	0.00374	1
        56	57	0.03430	0.09660	0.02420	1
        50	57	0.04740	0.13400	0.03320	1
        56	58	0.03430	0.09660	0.02420	1
        51	58	0.02550	0.07190	0.01788	1
        54	59	0.05030	0.22930	0.05980	1
        56	59	0.04070	0.12240	0.01380	1
        55	59	0.04739	0.21580	0.05646	1
        59	60	0.03170	0.14500	0.03760	1
        59	61	0.03280	0.15000	0.03880	1
        60	61	0.00264	0.01350	0.01456	1
        60	62	0.01230	0.05610	0.01468	1
        61	62	0.00824	0.03760	0.00980	1
        63	59	0.00000	0.03860	0.00000	0.96
        63	64	0.00172	0.02000	0.21600	1
        64	61	0.00000	0.02680	0.00000	0.98
        38	65	0.00901	0.09860	1.04600	1
        64	65	0.00269	0.03020	0.38000	1
        49	66	0.00900	0.04590	0.00620	1
        62	66	0.04820	0.21800	0.05780	1
        62	67	0.02580	0.11700	0.03100	1
        65	66	0.00000	0.03700	0.00000	0.93
        66	67	0.02240	0.10150	0.02682	1
        65	68	0.00138	0.01600	0.63800	1
        47	69	0.08440	0.27780	0.07092	1
        49	69	0.09850	0.32400	0.08280	1
        68	69	0.00000	0.03700	0.00000	0.935
        69	70	0.03000	0.12700	0.12200	1
        24	70	0.00221	0.41150	0.10198	1
        70	71	0.00882	0.03550	0.00878	1
        24	72	0.04880	0.19600	0.04880	1
        71	72	0.04460	0.18000	0.04444	1
        71	73	0.00866	0.04540	0.01178	1
        70	74	0.04010	0.13230	0.03368	1
        70	75	0.04280	0.14100	0.03600	1
        69	75	0.04050	0.12200	0.12400	1
        74	75	0.01230	0.04060	0.01034	1
        76	77	0.04440	0.14800	0.03680	1
        69	77	0.03090	0.10100	0.10380	1
        75	77	0.06010	0.19990	0.04978	1
        77	78	0.00376	0.01240	0.01264	1
        78	79	0.00546	0.02440	0.00648	1
        77	80	0.01080	0.03320	0.00280	1
        79	80	0.01560	0.07040	0.01870	1
        68	81	0.00175	0.02020	0.80800	1
        81	80	0.00000	0.03700	0.00000	0.935
        77	82	0.02980	0.08530	0.08174	1
        82	83	0.01120	0.03665	0.03796	1
        83	84	0.06250	0.13200	0.02580	1
        83	85	0.04300	0.14800	0.03480	1
        84	85	0.03020	0.06410	0.01234	1
        85	86	0.03500	0.12300	0.02760	1
        86	87	0.02828	0.20740	0.04450	1
        85	88	0.02000	0.10200	0.02760	1
        85	89	0.02390	0.17300	0.04700	1
        88	89	0.01390	0.07120	0.01934	1
        89	90	0.01630	0.06510	0.01760	1
        90	91	0.02540	0.08360	0.02140	1
        89	92	0.00790	0.03830	0.01180	1
        91	92	0.03870	0.12720	0.03268	1
        92	93	0.02580	0.08480	0.02180	1
        92	94	0.04810	0.15800	0.04060	1
        93	94	0.02230	0.07320	0.01876	1
        94	95	0.01320	0.04340	0.01110	1
        80	96	0.03560	0.18200	0.04940	1
        82	96	0.01620	0.05300	0.05440	1
        94	96	0.02690	0.08690	0.02300	1
        80	97	0.01830	0.09340	0.02540	1
        80	98	0.02380	0.10800	0.02860	1
        80	99	0.04540	0.20600	0.05460	1
        92	100	0.06480	0.29500	0.04720	1
        94	100	0.01780	0.05800	0.06040	1
        95	96	0.01710	0.05470	0.01474	1
        96	97	0.01730	0.08850	0.02400	1
        98	100	0.03970	0.17900	0.04760	1
        99	100	0.01800	0.08130	0.02160	1
        100	101	0.02770	0.12620	0.03280	1
        92	102	0.01230	0.05590	0.01464	1
        101	102	0.02460	0.11200	0.02940	1
        100	103	0.01600	0.05250	0.05360	1
        100	104	0.04510	0.20400	0.05410	1
        103	104	0.04660	0.15840	0.04070	1
        103	105	0.05350	0.16250	0.04080	1
        100	106	0.06050	0.22900	0.06200	1
        104	105	0.00994	0.03780	0.00986	1
        105	106	0.01400	0.05470	0.01434	1
        105	107	0.05300	0.18300	0.04720	1
        105	108	0.02610	0.07030	0.01844	1
        106	107	0.05300	0.18300	0.04720	1
        108	109	0.01050	0.02880	0.00760	1
        103	110	0.03906	0.18130	0.04610	1
        109	110	0.02780	0.07620	0.02020	1
        110	111	0.02200	0.07550	0.02000	1
        110	112	0.02470	0.06400	0.06200	1
        17	113	0.00913	0.03010	0.00768	1
        32	113	0.06150	0.20300	0.05180	1
        32	114	0.01350	0.06120	0.01628	1
        27	115	0.01640	0.07410	0.01972	1
        114	115	0.00230	0.01040	0.00276	1
        68	116	0.00034	0.00405	0.16400	1
        12	117	0.03290	0.14000	0.03580	1
        75	118	0.01450	0.04810	0.01198	1
        76	118	0.01640	0.05440	0.01356	1 
];
%G(1)=0.40; G(2)=0.20; G(3)=0.4;
lfybus                            % form the bus admittance matrix
lfnewton           % Load flow solution by Newton-Raphson method
busout              % Prints the power flow solution on the screen
lineflow          % computes and displays the line flow and losses
LSindex
%  Lmn_index_1 
%  
% % %Fvsi_index 
%  Fvsi_index_1 
% NCPI_index_3 

